<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
	
<ui:composition template="/WEB-INF/include/template.xhtml">
<ui:define name ="head">
	<h:outputStylesheet name = "css/bootstrap-tagsinput.css" />
	<h:outputStylesheet name = "css/initiative.css" />
	<h:outputStylesheet name = "dataTable/css/dataTables.bootstrap.min.css" />
</ui:define>
<ui:define name = "body">
	<br></br>
	<f:metadata>
	    <f:viewParam name="initiative" value="#{dInitiativeBean.initiative}" />
	</f:metadata>
	<h1>Iniciativa #{dInitiativeBean.initiative}</h1>
	<div class="container-fluid">
		<div class="row">
			<div class="col-xs-6">
				<h3>Interesados</h3>
				<h:panelGroup id="userInterested">
					<table id="interestedTable" class="table table-bordered table-striped">
						<thead>
							<tr>
								<th>Name</th>
								<th>Last Name</th>
								<th>Email</th>
							</tr>
						</thead>
						<tbody>
							<ui:repeat var="user" value="#{dInitiativeBean.getInterested()}">
							<tr>
								<td>#{user.name}</td>
								<td>#{user.lastName}</td>
								<td>#{user.email}</td>
							</tr>
							</ui:repeat>
						</tbody>
					</table>
				</h:panelGroup>
				
				<h:form>
					<p:commandButton value = "Interesado"  
						actionListener="#{dInitiativeBean.insertInterested()}" update=":userInterested" id="botonInteres" styleClass="btn btn-primary">
						<f:param name="initiative" value="#{dInitiativeBean.initiative}" />
				  	</p:commandButton>
					<p:commandButton value = "Dejar Interes"  
						actionListener="#{dInitiativeBean.deleteInterested()}" update=":userInterested" id="botonDejarInteres" styleClass="btn btn-default">
						<f:param name="initiative" value="#{dInitiativeBean.initiative}" />
				  	</p:commandButton>
				 </h:form>
				
				
			</div>
			<div class="col-xs-6"> 
			<h3>Comentarios</h3>
			<h:panelGroup id="comment_table">
			<table id="commentTable" class="table table-bordered table-striped">
					<thead>
						<tr>
							<th>Commet</th>
							<th>Date</th>
						</tr>
					</thead>
					<tbody>
						<ui:repeat var="comment" value="#{dInitiativeBean.getComments()}">
						<tr>
							<td>#{comment.comment}</td>
							<td>#{comment.date}</td>
						</tr>
						</ui:repeat>
					</tbody>
				</table>
				
			  		<h:panelGroup layout="block" rendered="#{ userBean.islogged()}">
						<td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addComment">Agregar comentario</button></td>
					</h:panelGroup>
				</h:panelGroup>
			</div>			
			<div class="col-xs-12">
			<h3>Informaci√≥n</h3>

			<table id="relatedTable" class="table table-bordered table-striped">
					<thead>
						<tr>
							<th>Descripcion</th>
							<th>Area</th>
							<th>Estado</th>
							<th>Votos</th>
						</tr>
					</thead>
					<tbody>
						<ui:repeat var="initiative" value="#{dInitiativeBean.getRelated()}">
						<tr>
							<td>#{initiative.description}</td>
							<td>#{initiative.area}</td>
							<td>#{initiative.status.status}</td>
							<td>#{initiative.numVotes}</td>	
						</tr>
						</ui:repeat>
					</tbody>
				</table>
			</div>
		</div>
	</div>
	
	
	<div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" id="addComment">
	  <div class="modal-dialog modal-sm" role="document">
	    <div class="modal-content">
	     <div class= "modal-header">
	     	<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	     	<h4>Agregue su comentario</h4>
	     </div>
	     <div class= "modal-body">
	     	<h:form id="comment_form">
			  <p:messages autoUpdate="true" />
			  <div class="form-group">
			  	<label for="Comment1">Comentario</label>
			   	<p:inputText id="comment" binding="#{comment}" styleClass="form-control" style = "height: 70px"/>
			  </div>
			  <p:commandButton value = "Comentar"
				actionListener="#{dInitiativeBean.insertComment(comment.value)}" id="boton" styleClass="btn btn-success">
			  </p:commandButton>
			</h:form>
	     </div>
	    </div>
	  </div>
	</div>

 	
	<h:outputScript name = "js/bootstrap-tagsinput.js" />

	<h:outputScript name = "dataTable/js/jquery.dataTables.min.js" />
	<h:outputScript name = "dataTable/js/dataTables.bootstrap.min.js" />
</ui:define>
</ui:composition>
</html>